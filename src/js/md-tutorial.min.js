'use strict';var mdTutorial;
(function(e){function k(d,c,a,h){function b(){var b="",f=a.current();a.list().length||(b+="hide-load");a.file(f)||(b+="hide-save-as hide-email hide-download");a.file(f)||f!==h||(b+="hide-save-as hide-email hide-download hide-remove hide-new");c.toggle(b)}b();this.setToggles=b;d.$on("$destroy",a.onUpdate(b))}function l(d,c){var a="";Object.keys(c).forEach(function(h){c[h].toggle&&(a+=c[h].toggle+" ")});d.toggle(a)}function g(d,c){Object.keys(c).forEach(function(a){a=c[a];d.when(a.path,{templateUrl:a.template,
controller:a.controller,controllerAs:a.controllerAs})});d.otherwise({redirectTo:"/sandbox"})}function d(d,c){return{replace:!0,scope:{},link:function(a){function h(b){a.toggle=b}function b(){a.prompt=!0}var m=d.onToggle(h),f=c.on(e.promptStates.input,b),p=c.on(e.promptStates.file,b),g=c.on(e.promptStates.bool,b),r=c.on("hide",function(){a.prompt=!1});h(d.toggle());a.$on("$destroy",function(){m();f();p();g();r()});a.prompt=c.state()!==e.promptStates.off},templateUrl:"html/frame.html"}}e.app=angular.module("md-tutorial",
["ngRoute","ngAria"]).config(g).value("appFlags",{worker:{error:null,is:!1},storage:{error:null,is:!1}}).directive("mdtFrame",d).controller("FirstTime",l).controller("Reference",l).controller("Tutorial",l).controller("About",l).controller("Sandbox",k);k.$inject=["$scope","mdtMenuState","mdtSandboxState","newFileLabel"];l.$inject=["mdtMenuState","mdtMenus"];g.$inject=["$routeProvider","mdtApplets"];d.$inject=["mdtMenuState","mdtPromptService"]})(mdTutorial||(mdTutorial={}));
(function(e){e.app.constant("mdtApplets",{about:{path:"/about",controller:"About",controllerAs:"about",template:"html/about.html"},sandbox:{path:"/sandbox",controller:"Sandbox",controllerAs:"sandbox",template:"html/sandbox.html"},tutorial:{path:"/tutorial",controller:"Tutorial",controllerAs:"tutorial",template:"html/tutorial.html"},reference:{path:"/reference",controller:"Reference",controllerAs:"reference",template:"html/reference.html"}})})(mdTutorial||(mdTutorial={}));
(function(e){e.app.constant("mdtMenus",{about:{label:"About",args:"/about",fn:"go",icon:"/img/icons/question-mark.svg",tabindex:900,onMenu:"secondary"},remove:{label:"Remove",args:"",fn:"remove",icon:"/img/icons/trash.svg",onMenu:"secondary",tabindex:160,toggle:"hide-remove"},mailto:{label:"Send",args:"",fn:"email",icon:"/img/icons/envelope-closed.svg",onMenu:"secondary",tabindex:150,toggle:"hide-email"},download:{label:"Download",args:"",fn:"download",icon:"/img/icons/data-transfer-download.svg",
onMenu:"secondary",tabindex:140,toggle:"hide-download"},startNew:{label:"New",args:"",fn:"promptNew",icon:"/img/icons/bolt.svg",onMenu:"secondary",tabindex:130,toggle:"hide-new"},load:{label:"Load",args:"",fn:"promptLoad",icon:"/img/icons/folder.svg",onMenu:"secondary",tabindex:120,toggle:"hide-load"},saveAs:{label:"Save As",args:"",fn:"promptSaveAs",icon:"/img/icons/file.svg",onMenu:"secondary",tabindex:110,toggle:"hide-save-as"},sandbox:{label:"Sandbox",args:"/sandbox",fn:"go",icon:"img/icons/pencil.svg",
tabindex:100,onMenu:"primary"},tutorial:{label:"Tutorial",args:"/tutorial",fn:"go",icon:"img/icons/location.svg",tabindex:200,onMenu:"primary"},reference:{label:"Reference",args:"/reference",fn:"go",icon:"img/icons/book.svg",tabindex:300,onMenu:"primary"}})})(mdTutorial||(mdTutorial={}));(function(e){e.app.constant("mdtTutorial",[{filename:"0-intro.md"},{filename:"1-workflow.md"},{filename:"2-basics-headings.md"}])})(mdTutorial||(mdTutorial={}));
(function(e){function k(n){function c(b,c){if(void 0===c)return a[b];a[b]=c;h.emitSync(b,c);return a[b]}var a={selected:d,toggle:""},h=n(this);this.prompt=function(a){return c("prompt",a)};this.toggle=function(a){return c("toggle",a)};this.selected=function(a){return c("selected",a)};this.onSelect=function(a){return h.on("selected",a)};this.onToggle=function(a){return h.on("toggle",a)};this.onPrompt=function(a){return h.on("prompt",a)}}function l(d,c,a,h,b,m,f){function p(){f.bool("Reset the new file, and lose all changes?",
"Reset","Keep").then(function(a){a&&b.file(h,"")})}function e(a){return(a=b.file(a))?a:null}function g(a,f){return a===h?f.slice(0,f.indexOf("\n")):a}this.go=function(f,b){c.path(f);a.selected(b)};this.email=function(){var a=b.current(),f=e(a),c="";f&&(c=g(a,f),d.location.href=["mailto:?subject=",encodeURIComponent(c),"&body=",encodeURIComponent(f)].join(""))};this.download=function(){var a=b.current(),f=e(a),c="",c=g(a,f);m.render(f).then(function(a){a="data:application/octet-stream,"+encodeURIComponent(a);
window.open(a,c+".html")},function(a){console.warn(a.message)})};this.remove=function(){var a=b.current();if(a===h)return p();f.bool("Permanently Remove "+a+"?","Remove","Keep").then(function(f){f&&(b.remove(a),b.current(h))})};this.promptLoad=function(){f.file("Load").then(function(a){b.current(a)})};this.promptSaveAs=function(){f.input("Save As").then(function(a){function c(){b.file(a,b.file(b.current()));p===h&&b.file(p,"");b.current(a)}var d=b.file(a),p=b.current();d?f.bool("Overwrite File: "+
a+"?","Overwrite","Cancel").then(function(a){a&&c()}):c()})};this.promptNew=function(){var a=b.current();a===h?(a=b.file(a))&&p():b.current(h)}}function g(d,c,a){function h(a){return function(c){return d[c].onMenu===a}}return{restrict:"E",replace:!0,link:function(b){var m,f;b.toggle="";b.selectors=Object.keys(d).filter(h(b.mdtMenu)).map(function(a){a=d[a];return{icon:a.icon,fn:a.fn,args:a.args,label:a.label,tabindex:a.tabindex,toggle:a.toggle}});b.select=function(f,b,c){if(a[f])a[f](b,c)};b.selected=
c.selected();b.toggle=c.toggle();m=c.onSelect(function(a){b.selected=a});f=c.onToggle(function(a){b.toggle=a});b.$on("$destroy",function(){m();f()})},scope:{mdtMenu:"@"},template:'<div class="mdt-applet-selectors"><mdt-applet-selector ng-repeat="selector in selectors"></mdt-applet-selector></div>'}}e.app.service("mdtMenuState",k).service("mdtMenuFunctions",l).directive("mdtAppletSelector",function(){return{restrict:"E",replace:!0,templateUrl:"html/applet-selector.html"}}).directive("mdtAppletSelectors",
g);var d="/sandbox";k.$inject=["mdtMakeListener"];l.$inject="$window $location mdtMenuState newFileLabel mdtSandboxState mdtMarked mdtPromptService".split(" ");g.$inject=["mdtMenus","mdtMenuState","mdtMenuFunctions"]})(mdTutorial||(mdTutorial={}));var __extends=this.__extends||function(e,k){function l(){this.constructor=e}for(var g in k)k.hasOwnProperty(g)&&(e[g]=k[g]);l.prototype=k.prototype;e.prototype=new l};
(function(e){e.app.factory("localStorage",function(){return new l});var k="mdt"+window.location.pathname,l=function(e){function d(){e.call(this,window.localStorage)}__extends(d,e);return d}(function(){function g(d){this.storage=d}g.prototype.set=function(d,e){return this.storage.setItem(k+d,e)};g.prototype.get=function(d){return this.storage.getItem(k+d)};g.prototype.list=function(d,g){var c,a,h=[];d=d||"";for(a=0;a<this.storage.length;a+=1)c=this.storage.key(a),0===c.indexOf(k+d)&&(c=c.slice(k.length),
h.push(c),e.safeCall(g,[null,c],this));return h};g.prototype.remove=function(d){return this.storage.removeItem(k+d)};g.prototype.removeAll=function(){var d=[];this.list(null,function(e,c){d.push(c)});d.forEach(this.remove.bind(this))};g.prototype.length=function(){var d=0;this.list(null,function(){d+=1});return d};return g}())})(mdTutorial||(mdTutorial={}));
(function(e){function k(c){return function(a){function d(a,b){return Array.prototype.slice.call(a,b||0)}function b(a){if(e[a]){var b=d(arguments,1);Object.keys(e[a]).forEach(function(c){l(e[a][c],b)})}}if(!a||"object"!==typeof a)return a;var e={};a.on&&(a._on=a.on);a.emit&&(a._emit=a.emit);a.on=function(a,b){if(!a||"function"!==typeof b)return angular.noop;e[a]||(e[a]={});var c=Date.now().toString(16)+Math.random();e[a][c]=b;return function(){delete e[a][c]}};a.emit=function(a){for(var g=1;g<arguments.length;g++);
if(e[a]){var n=d(arguments,0);c(function(){b.apply(null,n)},0)}};a.emitSync=b;a.__callbacks=e;return a}}function l(c,a,d){try{return c.apply(d||null,a)}catch(b){}}function g(c,a){a+="";for(var e=(c+"").toLowerCase().match(d),b=a.toLowerCase().match(d),m,f;e.length&&b.length;)if(m=e.shift(),f=b.shift(),n.test(m)||n.test(f)){if(!n.test(m))return 1;if(!n.test(f))return-1;if(m!=f)return m-f}else if(m!=f)return m>f?1:-1;return e.length-b.length}e.app.value("mdtSafeCall",l).value("mdtNaturalSort",g).factory("mdtMakeListener",
k);var d=/(\d+)|(\D+)/g,n=/\d+/;k.$inject=["$timeout"];e.safeCall=l;e.naturalSort=g})(mdTutorial||(mdTutorial={}));
(function(e){e.app.directive("mdtTap",function(){var e=500,l=15;return{restrict:"A",link:function(g,d,n){function c(a){var b=a;a.touches&&a.touches.length?(b=a.touches[0],1<a.touches.length&&(b=null)):a.changedTouches&&(b=a.changedTouches[0],1<a.changedTouches.length&&(b=null));return b}function a(){p=f=m=0}function h(b){b=c(b);if(null===b)return a();f=+b.clientX;p=+b.clientY;m=+Date.now()}function b(b){var d=c(b);if(null===d)return a();+Date.now()-m>e||Math.abs(+d.clientX-f)>l||Math.abs(+d.clientY-
p)>l||(g.$apply(n.mdtTap),a(),b.preventDefault())}var m=0,f,p,q=!1;angular.element(d).attr("ontouchstart"," ");d.on("focus",function(){q=!0});d.on("blur",function(){q=!1});d.on("touchend",function(a){a.preventDefault();b(a)});d.on("keypress",function(b){q&&(g.$apply(n.mdtTap),a(),b.preventDefault())});d.on("mouseup",b);d.on("mousedown",h);d.on("touchstart",h);d.on("$destroy",function(){d.off("mouseup");d.off("touchend");d.off("mousedown");d.off("touchstart");d.off("touchcancel");d.off("keypress");
d.off("focus");d.off("blur")});d.on("touchcancel",a)}}})})(mdTutorial||(mdTutorial={}));
(function(e){function k(g,d,n){function c(b,c){if(!b)return"";if(void 0===c){if(m[b])return m[b];m[b]=g.get(h+b);return m[b]}if(m[b]===c)return m[b];m[b]=c;g.set(h+b,c);a.emitSync("update");return m[b]}var a=d(this),h="sandbox-",b=n,m={};this.list=function(){return g.list(h).map(function(a){return a.slice(h.length)}).filter(function(a){return a!=n}).sort(e.naturalSort)};this.file=c;this.remove=function(a){m[a]&&delete m[a];g.remove(h+a)};this.current=function(c){if(void 0===c)return b;b=c;a.emitSync("update");
return b};this.onUpdate=function(b){return a.on("update",b)};this.saveAs=function(a,b,d){if(!c(a))return"file "+a+" not found";if(!d&&c(b))return"file "+b+" exists";c(b,c(a));a===n&&c(n,"");return""}}function l(e,d,n,c){return{replace:!0,scope:{mdtFile:"@",mdtCurrent:"@"},transclude:!0,link:function(a,h,b,m,f){function p(){a.md.input=c.file(c.current());l()}function l(){return d.render(a.md.input).then(function(d){a.md.output=e.trustAsHtml(d);b.mdtCurrent?c.file(c.current(),a.md.input):b.mdtFile&&
c.file(a.mdtFile,a.md.input)})}var k;a.md={input:"",output:"",update:n(l,150)};f(a,function(b){a.mdtFile||a.mdtCurrent||!(b=angular.element(b).text())||(a.md.input=b,l())});a.mdtCurrent?(p(),k=c.on("update",p)):a.mdtFile&&(a.md.input=c.file(a.mdtFile)||"",l());h.on("$destroy",function(){k&&k()})},templateUrl:"html/sandbox-directive.html"}}e.app.constant("newFileLabel","__new __file").service("mdtSandboxState",k).directive("mdtSandbox",l);k.$inject=["localStorage","mdtMakeListener","newFileLabel"];
l.$inject=["$sce","mdtMarked","throttle","mdtSandboxState"]})(mdTutorial||(mdTutorial={}));
(function(e){function k(d,c){var a=e.promptStates.off,h=c(this);this.input=function(b){function c(){g();l();a=e.promptStates.off;h.emit("hide")}var f=d.defer(),g,l;if(a!==e.promptStates.off)return f.reject(Error("promptInput: Prompt in progress")),f.promise;a=e.promptStates.input;h.emit(e.promptStates.input,b);g=h.on("provideInput",function(a){f.resolve(a);c()});l=h.on("cancel",function(){f.reject(Error("promptInput: Cancelled"));c()});return f.promise};this.file=function(b){function c(){g();l();
a=e.promptStates.off;h.emit("hide")}var f=d.defer(),g,l;if(a!==e.promptStates.off)return f.reject(Error("promptFile: Prompt in progress")),f.promise;a=e.promptStates.file;h.emit(e.promptStates.file,b);g=h.on("provideFile",function(a){f.resolve(a);c()});l=h.on("cancel",function(){f.reject(Error("promptInput: Cancelled"));c()});return f.promise};this.bool=function(b,c,f){var g=d.defer(),l;if(a!==e.promptStates.off)return g.reject(Error("promptInput: Prompt in progress")),g.promise;a=e.promptStates.bool;
h.emit(e.promptStates.bool,b,c,f);l=h.on("provideBool",function(b){g.resolve(b);l();a=e.promptStates.off;h.emit("hide")});return g.promise};this.state=function(){return a}}function l(d,c){return{restrict:"E",link:function(a,h){function b(){a.files=[];a.label="";a.show=d.state()===e.promptStates.file}var g=d.on(e.promptStates.file,function(b){a.files=c.list();a.label=b;a.show=!0});b();h.on("$destroy",function(){g()});a.files=[];a.go=function(){null!==a.selected&&(d.emitSync("provideFile",a.selected),
b())};a.cancel=function(){d.emitSync("cancel",a.data);b()};a.onClick=function(b){a.selected=a.selected===b?null:b};a.selected=null},scope:{},templateUrl:"html/prompt-file.html"}}function g(d,c){return{restrict:"E",link:function(a,h){function b(){a.data="";a.label="";a.show=d.state()===e.promptStates.input}var g=d.on(e.promptStates.input,function(b){a.data="";a.label=b;a.show=!0;var d=angular.element(h[0].children[0]).children()[0];c(function(){d.focus()},0)});b();h.on("$destroy",function(){g()});
a.go=function(){a.data&&(d.emitSync("provideInput",a.data),b())};a.cancel=function(){d.emitSync("cancel",a.data);b()}},scope:{},templateUrl:"html/prompt-input.html"}}function d(d){return{restrict:"E",link:function(c,a){function g(){c.label="";c.labelTrue="";c.labelFalse="";c.show=d.state()===e.promptStates.bool}var b=d.on(e.promptStates.bool,function(a,b,d){c.label=a;c.labelTrue=b;c.labelFalse=d;c.show=!0});g();a.on("$destroy",function(){b()});c.goTrue=function(){d.emitSync("provideBool",!0);g()};
c.goFalse=function(){d.emitSync("provideBool",!1);g()}},scope:{},templateUrl:"html/prompt-bool.html"}}e.app.service("mdtPromptService",k).directive("mdtPrompt",function(){return{restrict:"E",replace:!0,template:"<div><mdt-prompt-input></mdt-prompt-input><mdt-prompt-file></mdt-prompt-file><mdt-prompt-bool></mdt-prompt-bool></div>"}}).directive("mdtPromptFile",l).directive("mdtPromptBool",d).directive("mdtPromptInput",g);e.promptStates={input:"input",file:"file",off:"off",bool:"bool"};k.$inject=["$q",
"mdtMakeListener"];l.$inject=["mdtPromptService","mdtSandboxState"];g.$inject=["mdtPromptService","$timeout"];d.$inject=["mdtPromptService"]})(mdTutorial||(mdTutorial={}));
(function(e){function k(e,d){return function(l,c,a){function h(){q=!1===a.leading?0:d();k=null;f=l.apply(b,m);k||(b=m=null)}var b,m,f,k=null,q=0;a||(a={});return function(){var r=d(),s;q||!1!==a.leading||(q=r);s=c-(r-q);b=this;m=arguments;0>=s||s>c?(e.cancel(k),k=null,q=r,f=l.apply(b,m),k||(b=m=null)):k||!1===a.trailing||(k=e(h,s));return f}}}function l(e,d){return function(l,c,a){function h(){var r=d()-p;r<c&&0<r?b=e(h,c-r):(e.cancel(b),b=null,a||(q=l.apply(f,k),b||(f=k=null)))}var b,k,f,p,q;return function(){f=
this;k=Array.prototype.slice.call(arguments,0);p=d();var r=a&&!b;b||(b=e(h,c));r&&(q=l.apply(f,k),f=k=null);return q}}}e.app.factory("throttleNow",function(){return function(){return Date.now()}}).factory("throttle",k).factory("debounce",l);k.$inject=["$timeout","throttleNow"];l.$inject=["$timeout","throttleNow"]})(mdTutorial||(mdTutorial={}));
(function(e){function k(e,g,d){var k=[],c=[];d.forEach(function(a){k.push(e.get("md/tutorial/"+a.filename))});g.all(k).then(function(a){a.forEach(function(a){c.push(a.data)})})}e.app.service("tutorialFiles",k);k.$inject=["$http","$q","mdtTutorial"]})(mdTutorial||(mdTutorial={}));
(function(e){function k(d,e){function c(c,b){c?a.reject(c):a.resolve(b)}var a=g.defer();e?marked(d,e,c):marked(d,c);return a.promise}function l(d){g=d;this.render=k}var g;e.app.service("mdtMarked",l);marked.setOptions({gfm:!0,tables:!0,breaks:!0,pedantic:!1,smartLists:!0,smartypants:!0});l.$inject=["$q"]})(mdTutorial||(mdTutorial={}));
